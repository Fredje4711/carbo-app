<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Koolhydraten Scanner â€“ Installatie</title>

  <!-- Zelfde stijl als de app -->
  <link rel="stylesheet" href="style.css">

  <!-- PWA-koppeling -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2c7be5">

  <style>
    /* Extra styling specifiek voor deze pagina */

    main#install-page {
      max-width: 900px;
      margin: 0 auto;
      padding: 0.75rem 0.75rem 2rem;
    }

    .install-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }

    .install-card h2 {
      margin-top: 0;
      color: #2c7be5;
      font-size: 1.2rem;
    }

    .install-card p,
    .install-card li {
      font-size: 0.95rem;
    }

    .install-cta {
      text-align: center;
      margin: 1rem 0;
    }

    .btn-main {
      display: inline-block;
      background: #2c7be5;
      color: #fff;
      border: none;
      border-radius: 999px;
      padding: 0.7rem 1.4rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
    }

    .btn-main:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .btn-secondary {
      display: inline-block;
      margin-top: 0.5rem;
      background: #e1e9fb;
      color: #1b4fa8;
      border-radius: 999px;
      padding: 0.55rem 1.2rem;
      font-size: 0.95rem;
      border: none;
      text-decoration: none;
      cursor: pointer;
    }

    .device-note {
      font-size: 0.9rem;
      color: #555;
      text-align: center;
      margin-top: 0.5rem;
    }

    .platform-info {
      display: none; /* wordt door JS getoond per toestel */
      margin-top: 0.75rem;
      background: #f5f7ff;
      border-radius: 10px;
      padding: 0.75rem 0.9rem;
    }

    .platform-info h3 {
      margin-top: 0;
      margin-bottom: 0.4rem;
      font-size: 1rem;
      color: #2c7be5;
    }

    .platform-info ul {
      margin: 0.3rem 0 0.3rem 1.1rem;
      padding: 0;
    }

    .platform-info li {
      margin-bottom: 0.2rem;
    }

    .small-muted {
      font-size: 0.8rem;
      color: #666;
    }

    @media (min-width: 700px) {
      .install-flex {
        display: flex;
        gap: 1rem;
      }
      .install-flex > div {
        flex: 1;
      }
    }
  </style>

  <script>
    /* Service worker registreren */
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(() => console.log('SW geregistreerd op installatiepagina'))
          .catch(err => console.log('SW fout:', err));
      });
    }

    let deferredPrompt = null;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;

      const installSection = document.getElementById('android-install-section');
      const installButton  = document.getElementById('btn-install');
      const note           = document.getElementById('no-install-available');

      if (installSection && installButton) {
        installSection.style.display = 'block';
        installButton.disabled = false;
        if (note) note.style.display = 'none';
      }
    });

    function detectPlatform() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      const isAndroid = /Android/i.test(ua);
      const isIOS = /iPhone|iPad|iPod/i.test(ua);

      const iosInfo      = document.getElementById('ios-info');
      const androidInfo  = document.getElementById('android-info');
      const otherInfo    = document.getElementById('other-info');
      const androidBlock = document.getElementById('android-install-section');
      const note         = document.getElementById('no-install-available');

      if (isAndroid) {
        androidInfo.style.display = 'block';
        iosInfo.style.display = 'none';
        otherInfo.style.display = 'none';
        androidBlock.style.display = 'block';
        note.style.display = 'block';
      } else if (isIOS) {
        iosInfo.style.display = 'block';
        androidInfo.style.display = 'none';
        otherInfo.style.display = 'none';
        androidBlock.style.display = 'none';
      } else {
        otherInfo.style.display = 'block';
        iosInfo.style.display = 'none';
        androidInfo.style.display = 'none';
        androidBlock.style.display = 'none';
      }
    }

    async function handleInstallClick() {
      const installButton = document.getElementById('btn-install');
      const note = document.getElementById('no-install-available');

      if (!deferredPrompt) {
        note.textContent =
          'Drukte u per ongeluk op "Annuleren" of ging er iets mis? Geen probleem â€” sluit deze pagina volledig, wacht een paar minuten en open opnieuw de installatie-link vanuit uw e-mail. Dan krijgt u opnieuw de kans om te installeren.';
        note.style.display = 'block';
        return;
      }

      try {
        deferredPrompt.prompt();
        const choice = await deferredPrompt.userChoice;

        if (choice.outcome === 'accepted') {
          note.textContent =
            'Bedankt! De app is geÃ¯nstalleerd. U vindt ze terug bij uw apps, meestal op het laatste app-venster.';
          note.style.display = 'block';
        } else {
          note.textContent =
            'Geen probleem. U kunt later altijd opnieuw installeren door deze pagina opnieuw te openen via uw e-mail.';
          note.style.display = 'block';
        }
      } finally {
        deferredPrompt = null;
        installButton.disabled = true;
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      detectPlatform();
      document.getElementById('btn-install')
        ?.addEventListener('click', handleInstallClick);
    });
  </script>
</head>

<body>

<header>
  <h1>ğŸ½ï¸ Koolhydraten Scanner</h1>
  <p style="margin:0.2rem 0 0.5rem;">Uitleg & installatie op uw smartphone</p>
</header>

<main id="install-page">

  <section class="install-card">
    <h2>Hoe wilt u de app gebruiken?</h2>

    <div class="install-flex">
      <div>
        <h3>1ï¸âƒ£ Eerst even proberen (werkt onmiddellijk)</h3>
        <p>
          U kunt de app meteen gebruiken in uw browser zonder installatie.
          Ideaal om even te testen of alles naar wens werkt.
        </p>
        <div class="install-cta">
          <a href="index.html" class="btn-secondary">App openen zonder installatie</a>
        </div>
      </div>

      <div>
        <h3>2ï¸âƒ£ De app installeren op uw smartphone</h3>
        <p>
          Op Android kunt u de app installeren via de knop hieronder.  
          Op iPhone verschijnt geen installatieknop â€” daar gebruikt u
          <em>â€˜Zet op beginschermâ€™</em>.
        </p>

        <!-- ANDROID INSTALL -->
        <div id="android-install-section" class="install-cta" style="display:none;">
          <button id="btn-install" class="btn-main" disabled>
            ğŸ“² App installeren op deze smartphone
          </button>
          <p id="no-install-available" class="device-note" style="display:none;"></p>
        </div>

        <!-- ANDROID INFO -->
        <div id="android-info" class="platform-info">
          <h3>Android-smartphone gedetecteerd</h3>
          <p>Zo installeert u de app:</p>
          <ul>
            <li>1ï¸âƒ£ Tik op <strong>â€œApp installeren op deze smartphoneâ€</strong>.</li>
            <li>2ï¸âƒ£ Kies in de melding voor <strong>â€œInstallerenâ€</strong>.</li>
            <li>3ï¸âƒ£ De app verschijnt daarna tussen uw andere apps (meestal op het laatste app-venster).</li>
          </ul>

          <p class="small-muted">
            Drukte u per ongeluk op â€œAnnulerenâ€ of ging er iets mis?  
            Sluit deze pagina volledig â†’ wacht enkele minuten â†’  
            open opnieuw de installatie-link via uw e-mail.
          </p>
        </div>

        <!-- iPHONE INFO -->
        <div id="ios-info" class="platform-info">
          <h3>iPhone of iPad gedetecteerd</h3>
          <p>
            Op iPhone verschijnt geen installatieknop. Apple ondersteunt dit niet.  
            Volg deze stappen om de app toch te installeren:
          </p>
          <ul>
            <li>1ï¸âƒ£ Tik onderaan in Safari op het <strong>deel-icoontje</strong>.</li>
            <li>2ï¸âƒ£ Kies <strong>â€œZet op beginschermâ€</strong>.</li>
            <li>3ï¸âƒ£ Tik op <strong>â€œVoeg toeâ€</strong>.</li>
          </ul>

          <p class="small-muted">
            Ging er iets mis? Sluit Safari volledig, open uw e-mail opnieuw,  
            en tik opnieuw op de link.
          </p>
        </div>

        <!-- ANDERE APPARATEN -->
        <div id="other-info" class="platform-info">
          <h3>Dit is geen smartphone</h3>
          <p>
            Deze installatiepagina is bedoeld voor Android- en iPhone-smartphones.  
            U kunt de app wel gewoon gebruiken via de browser:
          </p>
          <div class="install-cta">
            <a href="index.html" class="btn-secondary">App openen zonder installatie</a>
          </div>
        </div>

      </div>
    </div>
  </section>

</main>

<footer class="app-footer">
  <div class="footer-card">
    <p>Â© 2025 â€“ Persoonlijk gebruik â€“</p>
    <p>Ontwikkeld door Freddy Sleeuwaert.</p>
    <p class="disclaimer">
      Deze applicatie ondersteunt bewustwording over koolhydraten.<br>
      De resultaten zijn indicatief en geen medisch advies.
    </p>
  </div>
</footer>

</body>
</html>
